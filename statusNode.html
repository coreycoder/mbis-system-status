<link rel="import"  href="https://polygit2.appspot.com/components/polymer/polymer.html">
<link href="../css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="../js/jquery.easypiechart.js"></script>

<dom-module id="mt-status-node">
    <template>
        <style>
            .contains {
                background: ghostwhite;
                border: 2px solid slategray;
                border-radius: 1px;

                width: 150px;
                height: 225px;

                float: left;
                display: inline-block;
                box-shadow: 0px 1px 10px 5px green;
            }

            .gauges {
                border-bottom: 2px solid gainsboro;
                margin: 5px;
                padding-bottom: 10px;
            }

            .chart {
                position: relative;
                display: inline-block;
                margin: 1px;
                text-align: center;
            }

            .signal {
                display: inline-block;
                margin: 2px;
                font-size: 10px;
            }

            .status {
                text-align: center;
                font-family: "Lucida Bright";
                font-size: 12px;
            }

            .image {
                text-align: center;
                font-size: 12px;
            }

            .node-name {
                font-family: "Lucida Bright";
                font-size: 18px;
                font-weight: lighter;
                text-align: left;
                margin: 2px;
                margin-left: 5px;
                margin-right: 2px;
                border-bottom: 2px solid gainsboro;
            }

            .circle {
                background: green;
                border-radius: 50%;
                width: 12px;
                height: 12px;
                margin: 5px;
                float: left;
                box-shadow: 0 0 2px 2px green;
            }

            .percent {
                position: absolute;
                display: inline-block;
                line-height: 30px;
                z-index: 2;
                padding-left: 7px;
                font-size: 10px;
            }
        </style>

        <div class="contains" name$="[[mtColor]]" id="testing">
            <div class="circle"></div>
            <div class="node-name">
                <span>[[mtName]]</span>
            </div>
            <div class="gauges">
                <div class="chart" data-percent="73" data-scale-color="#152937">
                    <span class="percent"></span>
                </div>
                <div class="chart" data-percent="31" data-scale-color="#ffb400">
                    <span class="percent"></span>
                </div>
                <div class="chart" data-percent="99" data-scale-color="#ffb400">
                    <span class="percent"></span>
                </div>

                <div class="signal">
                    <i class="fa fa-signal fa-3x"></i>
                </div>
            </div>
            <div class="status">
                <p>DPS - healthy</p>
                <p>DES 1 - healthy</p>
                <p>DES 2 - healthy</p>
            </div>
            <div class="image">
                <span></span>
                <i class$="[[mtImage]]"></i>
            </div>
        </div>
    </template>
    <script>
        Polymer({
            is: "mt-status-node",
            properties: {
                mtName: {
                    type: String,
                    notify: true
                },
                mtImage: {
                    type: String,
                    notify: true
                },
                mtColor: {
                    type: String,
                    notify: true
                }
            },
            ready: function () {
                $('.chart').easyPieChart({
                    animate: 2000,
                    size: 25,
                    barColor: function (percent) {
                        if (percent < 60)
                            return "green";
                        else if (percent < 90)
                            return "yellow";
                        else
                            return "red";
                    },
                    trackColor: false,
                    scaleColor: false,
                    scaleLength: 0,
                    lineWidth: 3,
                    lineCap: "butt",
                    trackWidth: 1,
                    onStep: function(from, to, percent) {
                        $(this.el).find('.percent').text(Math.round(percent));
                    }
                });

                $("body").on("colorChange", function(eventName, data) {
                    $(".circle").css("background", data);
                    console.log("Color has been changed successfully")
                });
                //initHandlers()

                function changeColor() {
                    var hehehe = $(this.$.testing);
                    var temp = hehehe.attr("name");
                    console.log(temp);
                    var shadow = "0px 1px 10px 5px " + temp;
                    $(".contains").css("box-shadow", shadow);;
                    shadow = "0 0 2px 2px " + temp;
                    $(".circle").css("box-shadow", shadow);
                    $(".circle").css("background", temp);

                }
                changeColor();


            }
        });

       //function initHandlers() {}


    </script>
</dom-module>

